<!DOCTYPE html>
<html>

<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
	<title>Estadística Computacional</title>
	<link rel="stylesheet" type="text/css" href="styles.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
</head>

<body>

	<div class="container">
		<div class="hero">
			<h1 class="name"><strong>David</strong> Martín Vela</h1>
			<span class="job-title">Estadística Computacional 20-21</span>
			<span class="email"> <a href="mailto: davidmv1996@correo.ugr.es">davidmv1996@correo.ugr.es</a></span>

			<h2 class="lead">Primera entrega de ejercicios</h2>
		</div>
	</div>

	<div class="container">
<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r">        <span class="hl com">## Establecemos la semilla </span>
        <span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">42</span><span class="hl std">)</span>
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 1</h2>
		<div class="list-card">
			<h3>
				Calcula la probabilidad de que al lanzar al aire dos monedas, salgan:
				<ol>
					<li>a) Dos caras</li>
					<li>b) Dos cruces</li>
					<li>c) Una cara y una cruz</li>
				</ol>
				<br>
				Escribe una función que simule el lanzamiento. Repite 15000 veces la simulación e indica las diferencias
				entre los valores observados y los teóricos.
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solucion: A pesar de que las monedas son similares supongamos que se pueden distinguir, llamémoslas </span>
<span class="hl com"># moneda 1 y moneda 2. Ahora tenemos cuatro posibles resultados: Cara-Cara, Cara-Cruz, Cruz-Cara, </span>
<span class="hl com"># Cruz-Cruz, si estos 4 resultados son igualmente probables entonces esta claro que las respectivas </span>
<span class="hl com"># probabilidades son: </span>
<span class="hl com"># a) Dos caras es 1/4 </span>
<span class="hl com"># b) Dos cruzes es 1/4</span>
<span class="hl com"># c) Una cara y una cruz es 2/4 = 1/2.</span>
<span class="hl com"># Creamos una función para simular n lanzamientos de las dos monedas donde devolvemos para cada</span>
<span class="hl com"># moneda una tabla que contabiliza el numero de caras y cruces que se obtienen con cada,</span>
<span class="hl com"># y el calculo de la frecuencia de los sucesos comentados anteriormente (la suma de las </span>
<span class="hl com"># veces que se producen cada uno de ellos entre el total)</span>

<span class="hl com"># La interpretación frecuentista nos dice que las probabilidades se entienden como una aproximación</span>
<span class="hl com"># matemática de frecuencias relativas cuando la frecuencia total tiende a infinito, elegimos un</span>
<span class="hl com"># numero de ensayos n suficientemente grande, y calculamos la proporción (lo que devolvemos en </span>
<span class="hl com"># nuestra funcion), nuestra proporción sera cercana a la probabilidad teórica calculada si n es</span>
<span class="hl com"># grande. Se ve que esto es cierto realizando el experimento aumentando el número de lanzamientos n.</span>


<span class="hl std">simular_dos_monedas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span> <span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">15000</span><span class="hl std">){</span>
        <span class="hl std">moneda_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Cara&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">), n,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl std">moneda_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Cara&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">), n,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl std">prob_cara_cara</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(moneda_1</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">moneda_2</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">prob_cruz_cruz</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(moneda_1</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">moneda_2</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">prob_cara_cruz</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">((moneda_1</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">moneda_2</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">)</span> <span class="hl opt">|</span> <span class="hl std">(moneda_1</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">moneda_2</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span><span class="hl std">))</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span>
                <span class="hl str">&quot;Resultados Moneda 1 =&quot;</span> <span class="hl std">=</span> <span class="hl kwd">table</span><span class="hl std">(moneda_1),</span>
                <span class="hl str">&quot;Resultados Moneda 2 =&quot;</span> <span class="hl std">=</span> <span class="hl kwd">table</span><span class="hl std">(moneda_2),</span>
                <span class="hl str">&quot;Probabilidad de sacar ambas cara =&quot;</span> <span class="hl std">= prob_cara_cara,</span>
                <span class="hl str">&quot;Probabilidad de sacar ambas cruz=&quot;</span> <span class="hl std">= prob_cruz_cruz,</span>
                <span class="hl str">&quot;Probabilidad de sacar cruz y cara=&quot;</span> <span class="hl std">= prob_cara_cruz))</span>
<span class="hl std">}</span>

<span class="hl com"># Para probar la función solo hay que cargar el fichero en R y llamarla con su nombre junto al </span>
<span class="hl com"># argumento, numero de lanzamientos que se quiera simular. </span>
<span class="hl kwd">simular_dos_monedas</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">15000</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Resultados Moneda 1 =`
## moneda_1
## Cara Cruz 
## 7515 7485 
## 
## $`Resultados Moneda 2 =`
## moneda_2
## Cara Cruz 
## 7626 7374 
## 
## $`Probabilidad de sacar ambas cara =`
## [1] 0.2561333
## 
## $`Probabilidad de sacar ambas cruz=`
## [1] 0.2467333
## 
## $`Probabilidad de sacar cruz y cara=`
## [1] 0.4971333
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Nuestros resultados teóricos coinciden con la simulación</span>
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 2</h2>
		<div class="list-card">
			<h3>
				Se lanza un dado dos veces, anotando el resultado del primer lanzamiento y, en segundo lugar, el del
				segundo.
				<ol>
					<li>1. Simula el proceso</li>
					<li>2. Repítelo 100000 veces y calcula las frecuencias de cada posible resultado</li>
					<li>3. Representa la superficie obtenida utilizando la orden outer y la orden persp</li>
					<li>4. Calcula la probabilidad de que la suma de ambas puntuaciones sea mayor que 9 y compárala con
						el resultado de la simulación anterior</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solucion: Este ejercicio es un poco abierto respecto a como considerar los dados, en mi caso,</span>
<span class="hl com"># obviamente considero que ambos tienen 6 caras, del 1 al 6, e implemento una función cuya entrada </span>
<span class="hl com"># sea n (numero de veces que se repite el proceso) y un booleano para mostrar o no mostrar la superficie </span>
<span class="hl com"># generada que genera. </span>
<span class="hl com"># Nuestra función devolverá 5 resultados, dos lista de frecuencias de cada dado,</span>
<span class="hl com"># otras dos de frecuencias relativas, y la probabilidad empírica de que sea mayor que 9.</span>
<span class="hl com"># Respecto a las frecuencias, nos referimos a que hemos supuesto considerar los dados por separado, </span>
<span class="hl com"># se podría haber considerado el resultado del proceso la suma de los resultados de los ambos dados pero</span>
<span class="hl com"># en mi caso los he considerado por separado (al final se haría de la misma manera tal vez creando una función)</span>
<span class="hl com"># que simule el lanzamiento de dos dados y devuelva la suma, y replicando el proceso n veces con la función</span>
<span class="hl com"># replicate.</span>

<span class="hl com"># Para la probabilidad, mayor que 9 significa 10, 11 o 12. La totalidad de posibilidades es 36.</span>
<span class="hl com"># 4 + 6 es 10, 5 + 5 es 10, 5 + 6 es 11, 6 + 4 es 10, 6 + 5 es 11, 6 + 6 es 12</span>
<span class="hl com"># Las posibilidades son 1 + 2 + 3, es decir, 6 sobre 36, esto, simplificado da 1 sobre 6. </span>
<span class="hl com"># Se observa que la probabilidad empírica se aproxima a la teórica conforme aumenta el número de lanzamientos.</span>
<span class="hl com"># Comparandolo con la superficie anterior podemos hacerlo contando el numero de &quot;cajas&quot;, los cubos agrupados </span>
<span class="hl com"># uno encima de otro, cuyo resultado al final seria el mismo</span>


<span class="hl std">simular_dos_dados</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">12</span><span class="hl std">,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">) {</span>
        <span class="hl std">caras</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span>
        <span class="hl std">dado_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">= n,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl std">dado_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">= n,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

        <span class="hl com"># Frecuencias</span>
        <span class="hl std">freq_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(dado_1)</span>
        <span class="hl std">freq_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(dado_2)</span>
        <span class="hl std">freq_relativa_1</span> <span class="hl kwb">&lt;-</span> <span class="hl std">freq_1</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">freq_relativa_2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">freq_2</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwa">if</span><span class="hl std">(plot</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span><span class="hl std">){</span>

                <span class="hl std">sorted_dado_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sort</span><span class="hl std">(dado_1)</span>
                <span class="hl std">sorted_dado_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sort</span><span class="hl std">(dado_2)</span>
                <span class="hl std">f_suma</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">,</span> <span class="hl kwc">y</span><span class="hl std">) { x</span><span class="hl opt">+</span><span class="hl std">y; }</span>
                <span class="hl std">z</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">outer</span><span class="hl std">(sorted_dado_1, sorted_dado_2, f_suma)</span>

                <span class="hl kwd">persp</span><span class="hl std">(z,</span>
                <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Superficie obtenida ejercicio 2&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;dado_1&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;dado_2&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">zlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Outer/ Multiplication&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">ticktype</span> <span class="hl std">=</span> <span class="hl str">&quot;simple&quot;</span><span class="hl std">)</span>
        <span class="hl std">}</span>

        <span class="hl com"># Probabilidad de que la suma sea mayor que 9</span>
        <span class="hl std">prob_9</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">((dado_1</span> <span class="hl opt">+</span> <span class="hl std">dado_2)</span> <span class="hl opt">&gt;</span> <span class="hl num">9</span> <span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwd">return</span><span class="hl std">(</span> <span class="hl kwd">list</span><span class="hl std">(</span>
                <span class="hl str">&quot;Frecuencias primer dado=&quot;</span> <span class="hl std">=freq_1,</span>
                <span class="hl str">&quot;Frecuencias segundo dado=&quot;</span> <span class="hl std">= freq_2,</span>
                <span class="hl str">&quot;Frecuencias relativas primer dado=&quot;</span> <span class="hl std">= freq_relativa_1,</span>
                <span class="hl str">&quot;Frecuencias relativas segundo dado=&quot;</span> <span class="hl std">=freq_relativa_2,</span>
                <span class="hl str">&quot;Probabilidad de que la suma sea mayor que 9=&quot;</span> <span class="hl std">=prob_9) )</span>
<span class="hl std">}</span>


<span class="hl com"># Para probar la función solo hay que cargar el fichero en R y llamarla con su nombre junto al argumento, </span>
<span class="hl com"># bastaría con introducir el número de veces que se quiere simular el lanzamiento de los dos dados</span>

<span class="hl kwd">simular_dos_dados</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">100000</span><span class="hl std">,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias primer dado=`
## dado_1
##     1     2     3     4     5     6 
## 16876 16727 16585 16668 16608 16536 
## 
## $`Frecuencias segundo dado=`
## dado_2
##     1     2     3     4     5     6 
## 16546 16820 16693 16656 16491 16794 
## 
## $`Frecuencias relativas primer dado=`
## dado_1
##       1       2       3       4       5       6 
## 0.16876 0.16727 0.16585 0.16668 0.16608 0.16536 
## 
## $`Frecuencias relativas segundo dado=`
## dado_2
##       1       2       3       4       5       6 
## 0.16546 0.16820 0.16693 0.16656 0.16491 0.16794 
## 
## $`Probabilidad de que la suma sea mayor que 9=`
## [1] 0.16634
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># para mostrar la superficie hemos creado la funcion f_suma para que outer la</span>
<span class="hl com"># utilize (aunque visualmente seria lo mismo que multiplicar elemento por elemento de cada vector)</span>
<span class="hl com"># para visualizar la grafica se llamaría añadiendo el argumento TRUE</span>

<span class="hl kwd">simular_dos_dados</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">120</span><span class="hl std">,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" class="plot" /></div><div class="rcode">
<div class="output"><pre class="knitr r">## $`Frecuencias primer dado=`
## dado_1
##  1  2  3  4  5  6 
## 19 13 20 22 24 22 
## 
## $`Frecuencias segundo dado=`
## dado_2
##  1  2  3  4  5  6 
## 21 17 18 22 23 19 
## 
## $`Frecuencias relativas primer dado=`
## dado_1
##         1         2         3         4         5         6 
## 0.1583333 0.1083333 0.1666667 0.1833333 0.2000000 0.1833333 
## 
## $`Frecuencias relativas segundo dado=`
## dado_2
##         1         2         3         4         5         6 
## 0.1750000 0.1416667 0.1500000 0.1833333 0.1916667 0.1583333 
## 
## $`Probabilidad de que la suma sea mayor que 9=`
## [1] 0.2083333
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Mostrar la superficie es computacionalmente caro debido a la multiplicación elemento a elemento de outer y a </span>
<span class="hl com"># mostrar de persp, por eso es mejor lo mostramos con menos repeticiones ya que se ve visualmente el resultado</span>
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 3</h2>
		<div class="list-card">
			<h3>
				Un dado está cargado de tal forma que las probabilidades de obtener las distintas caras son inversamente
				proporcionales a los números de estas. Calcula:

				<ol>
					<li>1 La probabilidad de obtener un 6 en un lanzamiento</li>
					<li>2 La probabilidad de obtener un número impar en un lanzamiento</li>
					<li>3. Realiza el ejercicio anterior con este tipo de dado</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución: La probabilidad es inversamente proporcional quiere decir que si la probabilidad de que salga 1 es p,</span>
<span class="hl com"># la probabilidad de que salga 2 sera 2/p y así hasta 6/p. (p + p/2 + p/3 + p/4 + p/5 + p/6 = 1)</span>
<span class="hl com"># Operando obtenemos que p = 20/49 (aprox) 0.408. Luego calculando las probabilidades que se nos pide teóricamente</span>
<span class="hl com"># tendríamos que la probabilidad de obtener un 6 es p/6 = (20/49)/6 = 20/294 (aprox) 0.068</span>
<span class="hl com"># De igual manera, la probabilidad de obtener un número impar sería la suma de probabilidades de </span>
<span class="hl com"># los tres números impares, p + p/3 + p/5 = (23 p)/15 = 92/147 (aprox) 0.62</span>
<span class="hl com"># Para probar las funciones solo hay que cargar el fichero en R y llamarlas con su nombre </span>
<span class="hl com"># junto a su argumento.</span>
<span class="hl com"># La función dado truncado simula el lanzamiento del dado truncado.</span>
<span class="hl std">dado_truncado</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">1000</span><span class="hl std">){</span>
        <span class="hl std">caras</span> <span class="hl kwb">=</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span>
        <span class="hl std">prob_truncada</span> <span class="hl kwb">=</span> <span class="hl num">1</span> <span class="hl opt">/</span> <span class="hl std">caras</span> <span class="hl com"># c(1,1/2,1/3,1/4,1/5,1/6)</span>

        <span class="hl std">dice</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(caras, n,</span> <span class="hl kwc">prob</span> <span class="hl std">= prob_truncada,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl com"># Tabla de frecuencias</span>
        <span class="hl std">freq</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(dice)</span>

        <span class="hl com"># Calculamos probabilidades</span>
        <span class="hl com"># Probabilidad de que salga un 6</span>
        <span class="hl std">prob_6</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(dice</span> <span class="hl opt">==</span> <span class="hl num">6</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl com"># Probabilidad de que sea un numero impar</span>
        <span class="hl std">prob_impar</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">( (dice</span> <span class="hl opt">%%</span> <span class="hl num">2</span><span class="hl std">)</span> <span class="hl opt">!=</span> <span class="hl num">0</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Frecuencias=&quot;</span> <span class="hl std">= freq,</span>
                <span class="hl str">&quot;Probabilidad de sacar un 6=&quot;</span> <span class="hl std">= prob_6,</span>
                <span class="hl str">&quot;Probabilidad de que el numero sea impar=&quot;</span> <span class="hl std">= prob_impar))</span>
<span class="hl std">}</span>

<span class="hl com"># Podemos visualizar esto ejecutando la función dado_truncado con un gran numero de repeticiones </span>
<span class="hl com"># n grande, hacemos hincapié en lo añadido a la función sample, para añadir la proporción inversa</span>
<span class="hl com"># de los números que queremos sacar. </span>
<span class="hl kwd">dado_truncado</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">100000</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias=`
## dice
##     1     2     3     4     5     6 
## 40664 20396 13829 10103  8164  6844 
## 
## $`Probabilidad de sacar un 6=`
## [1] 0.06844
## 
## $`Probabilidad de que el numero sea impar=`
## [1] 0.62657
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># donde el resultado sería el que esperábamos teóricamente,</span>

<span class="hl com"># En el apartado 3, simplemente añadimos la modificación de sample al ejercicio anterior,</span>
<span class="hl com"># como cabía de esperar obtenemos una probabilidad distinta y la figura que se forma es </span>
<span class="hl std">simular_dos_dados_truncados</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">12</span><span class="hl std">,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">) {</span>
        <span class="hl std">caras</span> <span class="hl kwb">=</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span>
        <span class="hl std">prob_truncada</span> <span class="hl kwb">=</span> <span class="hl num">1</span> <span class="hl opt">/</span> <span class="hl std">caras</span> <span class="hl com"># c(1,1/2,1/3,1/4,1/5,1/6)</span>

        <span class="hl std">dice_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">= n,</span> <span class="hl kwc">prob</span> <span class="hl std">= prob_truncada,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl std">dice_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">= n,</span> <span class="hl kwc">prob</span> <span class="hl std">= prob_truncada,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

        <span class="hl com"># Frecuencias</span>
        <span class="hl std">freq_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(dice_1)</span>
        <span class="hl std">freq_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(dice_2)</span>
        <span class="hl com"># Frecuencias relativas</span>
        <span class="hl std">freq_relativa_1</span> <span class="hl kwb">&lt;-</span> <span class="hl std">freq_1</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">freq_relativa_2</span> <span class="hl kwb">&lt;-</span> <span class="hl std">freq_2</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwa">if</span><span class="hl std">(plot</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span><span class="hl std">){</span>

                <span class="hl std">sorted_dice_1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sort</span><span class="hl std">(dice_1)</span>
                <span class="hl std">sorted_dice_2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sort</span><span class="hl std">(dice_2)</span>
                <span class="hl std">f_suma</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">,</span> <span class="hl kwc">y</span><span class="hl std">) { x</span><span class="hl opt">+</span><span class="hl std">y; }</span>
                <span class="hl std">z</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">outer</span><span class="hl std">(sorted_dice_1, sorted_dice_2, f_suma)</span>

                <span class="hl kwd">persp</span><span class="hl std">(z,</span>
                <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Superficie obtenida ejercicio 3&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;dice_1&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;dice_2&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">zlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Outer/ Multiplication&quot;</span><span class="hl std">,</span>
                <span class="hl kwc">ticktype</span> <span class="hl std">=</span> <span class="hl str">&quot;simple&quot;</span><span class="hl std">)</span>
        <span class="hl std">}</span>

        <span class="hl com"># Probabilidad de que la suma sea mayor que 9</span>
        <span class="hl std">prob_9</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">((dice_1</span> <span class="hl opt">+</span> <span class="hl std">dice_2)</span> <span class="hl opt">&gt;</span> <span class="hl num">9</span> <span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwd">return</span><span class="hl std">(</span> <span class="hl kwd">list</span><span class="hl std">(</span>
                <span class="hl str">&quot;Frecuencias primer dado=&quot;</span> <span class="hl std">=freq_1,</span>
                <span class="hl str">&quot;Frecuencias segundo dado=&quot;</span> <span class="hl std">= freq_2,</span>
                <span class="hl str">&quot;Frecuencias relativas primer dado=&quot;</span> <span class="hl std">= freq_relativa_1,</span>
                <span class="hl str">&quot;Frecuencias relativas segundo dado=&quot;</span> <span class="hl std">=freq_relativa_2,</span>
                <span class="hl str">&quot;Probabilidad de que la suma sea mayor que 9=&quot;</span> <span class="hl std">=prob_9) )</span>
<span class="hl std">}</span>
<span class="hl com"># es mucho mayor al inicio (caras de 1) y mucho más pequeña en los cubos del final, en </span>
<span class="hl com"># las caras superiores, podemos ver esto ejecutando la función simular_dos_dados_truncados</span>
<span class="hl kwd">simular_dos_dados_truncados</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">120</span><span class="hl std">,</span> <span class="hl kwc">plot</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div><div class="rcode">
<div class="output"><pre class="knitr r">## $`Frecuencias primer dado=`
## dice_1
##  1  2  3  4  5  6 
## 38 27 15 17 10 13 
## 
## $`Frecuencias segundo dado=`
## dice_2
##  1  2  3  4  5  6 
## 47 28 17 14  6  8 
## 
## $`Frecuencias relativas primer dado=`
## dice_1
##          1          2          3          4          5          6 
## 0.31666667 0.22500000 0.12500000 0.14166667 0.08333333 0.10833333 
## 
## $`Frecuencias relativas segundo dado=`
## dice_2
##          1          2          3          4          5          6 
## 0.39166667 0.23333333 0.14166667 0.11666667 0.05000000 0.06666667 
## 
## $`Probabilidad de que la suma sea mayor que 9=`
## [1] 0.03333333
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 4</h2>
		<div class="list-card">
			<h3>
				Una urna contiene 5 bolas rojas, 8 blancas y 3 negras.
				<ol>
					<li>1. Escribe sendas funciones que simulen la extracción con reemplazamiento y sin reemplazamiento
						de
						cinco bolas al azar.</li>
					<li>2. Calcula las probabilidades de los siguientes sucesos.</li>
					<br>
					<ol>
						<li>a) Que haya 2 bolas blancas</li>
						<li>b) que haya 2 bolas blancas y una roja</li>
						<li>c) que haya al menos 2 bolas negras</li>
					</ol>
					<br>
					<li>3. Repite 15000 veces la simulación e indica las diferencias entre los valores observados y los
						teóricos.</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución:  Para probar las funciones solo hay que cargar el fichero y </span>
<span class="hl com"># llamarlas con su nombre. </span>

<span class="hl com"># Primero, creamos una función extraer_5_bolas para simular la extracción de 5 bolas de una urna,</span>
<span class="hl com"># los argumentos de esta función son un boolean para indicar si esta extracción es con o sin</span>
<span class="hl com"># reemplazamiento. </span>

<span class="hl std">extraer_5_bolas</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">){</span>
        <span class="hl com"># Generamos vector de bolas</span>
        <span class="hl std">bolas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rep</span><span class="hl std">(</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Roja&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Blanca&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span><span class="hl std">),</span> <span class="hl kwc">times</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">5</span><span class="hl std">,</span><span class="hl num">8</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">))</span>
        <span class="hl com"># Número de bolas</span>
        <span class="hl std">n_bolas</span> <span class="hl kwb">=</span> <span class="hl num">5</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sample</span><span class="hl std">(bolas,</span> <span class="hl kwc">size</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">replace</span> <span class="hl std">= reemplazamiento))</span>
<span class="hl std">}</span>
<span class="hl com"># A esta función se le puede llamar:</span>
<span class="hl kwd">extraer_5_bolas</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Roja&quot;   &quot;Blanca&quot; &quot;Blanca&quot; &quot;Negra&quot;  &quot;Roja&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">extraer_5_bolas</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Roja&quot;   &quot;Roja&quot;   &quot;Roja&quot;   &quot;Blanca&quot; &quot;Roja&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Aunque se pedían sendas funciones, ya que es repetir código pero cambiando el argumento</span>
<span class="hl com"># he optado por unificarlas en una.</span>

<span class="hl com"># Seguidamente, definimos otra función, extraccion_urna para simular n_repeticiones extracciones 5</span>
<span class="hl com"># bolas con o sin reemplazamiento, lo cuál controlamos con un parámetro boleano reemplazamiento.</span>
<span class="hl std">extraccion_urna</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n_repeticiones</span> <span class="hl std">=</span> <span class="hl num">16</span><span class="hl std">,</span> <span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">){</span>


        <span class="hl com"># Repeticiones n_repeticiones veces la extracción de n_bolas </span>
        <span class="hl std">simulacion</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(n_repeticiones,</span> <span class="hl kwd">extraer_5_bolas</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">= reemplazamiento))</span>

        <span class="hl com"># Vemos los casos cuya probabilidad hay que calcular</span>
        <span class="hl std">casos_2_blancas</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>
        <span class="hl std">casos_2_blancas_1_roja</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>
        <span class="hl std">casos_al_menos_2_negras</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>

        <span class="hl kwa">for</span><span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl std">n_repeticiones) {</span>

                <span class="hl kwa">if</span><span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(simulacion[,i]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Blanca&quot;</span><span class="hl std">))</span> <span class="hl opt">==</span> <span class="hl num">2</span><span class="hl std">){</span>
                        <span class="hl std">casos_2_blancas</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_2_blancas</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl kwa">if</span><span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(simulacion[,i]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Blanca&quot;</span><span class="hl std">))</span> <span class="hl opt">==</span> <span class="hl num">2</span> <span class="hl opt">&amp;&amp;</span> <span class="hl kwd">length</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(simulacion[,i]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Roja&quot;</span><span class="hl std">))</span> <span class="hl opt">==</span> <span class="hl num">1</span><span class="hl std">){</span>
                        <span class="hl std">casos_2_blancas_1_roja</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_2_blancas_1_roja</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl kwa">if</span><span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(</span><span class="hl kwd">which</span><span class="hl std">(simulacion[,i]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Negra&quot;</span><span class="hl std">))</span> <span class="hl opt">&gt;</span> <span class="hl num">1</span><span class="hl std">){</span>
                        <span class="hl std">casos_al_menos_2_negras</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_al_menos_2_negras</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>
        <span class="hl std">}</span>

        <span class="hl com"># La probabilidad es los casos favorables entre el total</span>
        <span class="hl std">prob_2_blancas</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_2_blancas</span> <span class="hl opt">/</span> <span class="hl std">n_repeticiones</span>
        <span class="hl std">prob_2_blancas_1_roja</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_2_blancas_1_roja</span> <span class="hl opt">/</span> <span class="hl std">n_repeticiones</span>
        <span class="hl std">prob_al_menos_2_negras</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_al_menos_2_negras</span> <span class="hl opt">/</span> <span class="hl std">n_repeticiones</span>


        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Frecuencias=&quot;</span><span class="hl std">=</span><span class="hl kwd">table</span><span class="hl std">(simulacion),</span>
                <span class="hl str">&quot;Probabilidad 2 blancas=&quot;</span><span class="hl std">=prob_2_blancas,</span>
                <span class="hl str">&quot;Probabilidad 2 blancas y 1 roja=&quot;</span><span class="hl std">=prob_2_blancas_1_roja,</span>
                <span class="hl str">&quot;Probabilidad al menos 2 negras=&quot;</span><span class="hl std">=prob_al_menos_2_negras))</span>
<span class="hl std">}</span>

<span class="hl com"># El calculo empírico de los sucesos que se piden anteriormente es la suma de las </span>
<span class="hl com"># veces que se producen cada uno de ellos entre el total. Para ello en la función recorremos las columnas</span>
<span class="hl com"># del parámetro simulacion, el cual contiene el conjunto de experimentos de 5 en 5 n_repeticiones,</span>
<span class="hl com"># contamos los casos que se piden y calculamos la probabilidad dividiendo entre el total.</span>
<span class="hl com"># Finalmente la función devuelve una tabla con las frecuencias de cada bola, junto a las probabilidades</span>
<span class="hl com"># calculadas empíricamente mediante las observaciones.</span>

<span class="hl com"># Un ejemplo de ejecución sería:</span>
<span class="hl kwd">extraccion_urna</span><span class="hl std">(</span><span class="hl kwc">n_repeticiones</span> <span class="hl std">=</span> <span class="hl num">15000</span><span class="hl std">,</span> <span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias=`
## simulacion
## Blanca  Negra   Roja 
##  37502  13938  23560 
## 
## $`Probabilidad 2 blancas=`
## [1] 0.3082667
## 
## $`Probabilidad 2 blancas y 1 roja=`
## [1] 0.07886667
## 
## $`Probabilidad al menos 2 negras=`
## [1] 0.2320667
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">extraccion_urna</span><span class="hl std">(</span><span class="hl kwc">n_repeticiones</span> <span class="hl std">=</span> <span class="hl num">15000</span><span class="hl std">,</span> <span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias=`
## simulacion
## Blanca  Negra   Roja 
##  37374  14030  23596 
## 
## $`Probabilidad 2 blancas=`
## [1] 0.3594667
## 
## $`Probabilidad 2 blancas y 1 roja=`
## [1] 0.09193333
## 
## $`Probabilidad al menos 2 negras=`
## [1] 0.2112667
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Segundo, las probabilidades teóricas pueden calcularse con la distribución multinomial (con reemplazamiento)</span>
<span class="hl com"># y la hipergeométrica Multivariante (sin reemplazamiento), sumando las probabilidades de los posibles casos </span>
<span class="hl com"># que se piden. Para utilizar la distribución hipergeométrica en R hemos tenido que instalar el paquete extraDistr</span>
<span class="hl com"># mediante la orden:</span>
<span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;extraDistr&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## The downloaded binary packages are in
## 	/var/folders/_r/46skybsx7nz84cxqb358mz600000gn/T//Rtmpp5SswP/downloaded_packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Actualmente esta comentada en el código pero si no dispone de ese paquete se puede descomentar para la función </span>
<span class="hl com"># instale el paquete.</span>

<span class="hl std">probabilidades_teoricas</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">){</span>

        <span class="hl std">n_bolas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">8</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">5</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">)</span>
        <span class="hl std">extracciones</span> <span class="hl kwb">&lt;-</span> <span class="hl num">5</span>

        <span class="hl kwa">if</span><span class="hl std">(reemplazamiento){</span>
                <span class="hl com"># Probabilidad 2 blancas, suma de la probabilidad de cada caso</span>
                <span class="hl std">prob_2_blancas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas);</span>

                <span class="hl com"># Probabilidad 2 blancas 1 roja, suma de la probabilidad de cada caso	</span>
                <span class="hl std">prob_2_blancas_1_roja</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas);</span>

                <span class="hl com"># Probabilidad al menos 2 negras, suma de la probabilidad de cada caso</span>
                <span class="hl std">prob_al_menos_2_negras</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmultinom</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">prob</span> <span class="hl std">= n_bolas);</span>
        <span class="hl std">}</span> <span class="hl kwa">else</span> <span class="hl std">{</span>
                <span class="hl com"># install.packages(&quot;extraDistr&quot;);</span>
                <span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">&quot;extraDistr&quot;</span><span class="hl std">);</span>

                <span class="hl std">prob_2_blancas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones);</span>

                <span class="hl com"># Probabilidad 2 blancas 1 roja, suma de la probabilidad de cada caso	</span>
                <span class="hl std">prob_2_blancas_1_roja</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones);</span>

                <span class="hl com"># Probabilidad al menos 2 negras, suma de la probabilidad de cada caso</span>
                <span class="hl std">prob_al_menos_2_negras</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones)</span> <span class="hl opt">+</span>
                                        <span class="hl kwd">dmvhyper</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Blanca&quot;</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl str">&quot;Roja&quot;</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl str">&quot;Negra&quot;</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span> <span class="hl kwc">n</span> <span class="hl std">= n_bolas,</span> <span class="hl kwc">k</span> <span class="hl std">= extracciones);</span>
        <span class="hl std">}</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Probabilidad 2 blancas=&quot;</span><span class="hl std">=prob_2_blancas,</span>
                <span class="hl str">&quot;Probabilidad 2 blancas y 1 roja=&quot;</span><span class="hl std">=prob_2_blancas_1_roja,</span>
                <span class="hl str">&quot;Probabilidad al menos 2 negras=&quot;</span><span class="hl std">=prob_al_menos_2_negras))</span>
<span class="hl std">}</span>
<span class="hl com"># Para llamar a la función basta con escribir su nombre junto al tipo de reemplazamiento que se desea</span>
<span class="hl kwd">probabilidades_teoricas</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Probabilidad 2 blancas=`
## [1] 0.3125
## 
## $`Probabilidad 2 blancas y 1 roja=`
## [1] 0.08239746
## 
## $`Probabilidad al menos 2 negras=`
## [1] 0.2320862
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">probabilidades_teoricas</span><span class="hl std">(</span><span class="hl kwc">reemplazamiento</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Probabilidad 2 blancas=`
## [1] 0.3589744
## 
## $`Probabilidad 2 blancas y 1 roja=`
## [1] 0.09615385
## 
## $`Probabilidad al menos 2 negras=`
## [1] 0.2142857
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 5</h2>
		<div class="list-card">
			<h3>
				Disponemos de una moneda que está trucada, de tal modo que la probabilidad de obtener cara es triple que
				la de obtener cruz.
				<br>
				Considera la variable X definida del siguiente modo: Lanzamos la moneda dos veces consecutivas. Si se
				obtiene Cara en el primer lanzamiento y Cruz en el segundo, Tomamos X=1. Si se obtiene Cruz en el primer
				lanzamiento y Cara en el segundo, Tomamos X=2. En caso contrario se vuelve a lanzar la moneda dos veces.
				<ol>
					<li>1. Calcula la función de densidad de la variable X</li>
					<li>2. Escribe una función que simule esta variable aleatoria.</li>
					<li>3. Repite 15000 veces la simulación e indica la diferencia entre los valores observados y los
						teóricos</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución:  Para probar las funciones solo hay que cargar el fichero y </span>
<span class="hl com"># llamarlas con su nombre y argumentos</span>
<span class="hl com"># Primero, si la probabilidad de que salga cara es tres veces la probabilidad de que</span>
<span class="hl com"># salga cruz, sea P[Cara] = 3*P[Cruz] = p. Entonces, como P[Cara] + P[Cruz] = 1, obtenemos</span>
<span class="hl com"># 3(1-p) = p y p = 3/4, por lo tanto una secuencia de dos monedas independientes:</span>
<span class="hl com"># Pr[Cara Cara]=(3/4)^2=9/16</span>
<span class="hl com"># Pr[Cara Cruz]=(3/4)(1/4)=3/16</span>
<span class="hl com"># Pr[Cruz Cara]=(1/4)(3/4)=3/16</span>
<span class="hl com"># Pr[Cruz Cruz]=(1/4)^2=1/16</span>
<span class="hl com"># Pero claro, si después de dos lanzamientos de moneda no obtenemos ni Cara Cruz ni</span>
<span class="hl com"># Cruz Cara, entonces lanzamos las dos monedas de nuevo, luego como la probabilidad</span>
<span class="hl com"># de que P[Cara Cruz] = P[Cruz Cara], debemos de tener que</span>
<span class="hl com"># Pr[X=1]=Pr[X=2]=1/2</span>
<span class="hl com"># También podemos calcular esto así:</span>
<span class="hl com"># Pr[X=1]=Pr[Cara Cruz] / (Pr[Cara Cruz]+Pr[Cruz Cara])=(3/16)(6/16)=1/2,</span>
<span class="hl com"># y de igual manera con Pr[X=2]</span>

<span class="hl com"># Esta es la forma típica de simular un lanzamiento de moneda justo utilizando </span>
<span class="hl com"># una moneda injusta, y esa sería nuestra función de densidad / masa de probabilidad</span>

<span class="hl com"># Para simular esta variable aleatoria, creamos una función recursiva (que se </span>
<span class="hl com"># llama a ella misma) lanzas_dos_monedas_truncadas</span>
<span class="hl com"># sin argumento, la cuál recrea el lanzamiento de la moneda truncada dos veces </span>
<span class="hl com"># añadiendo la condición de que si no sale ni el caso 1 ni el caso 2, repetimos de nuevo el </span>
<span class="hl com"># lanzamiento de las dos monedas hasta que salga el caso 1 o el caso 2.</span>
<span class="hl std">lanzas_dos_monedas_truncadas</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
        <span class="hl std">moneda</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Cara&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">)</span>
        <span class="hl com"># Lanzamiento de dos monedas</span>
        <span class="hl std">dos_monedas</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(moneda,</span> <span class="hl kwc">prob</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">3</span><span class="hl opt">/</span><span class="hl num">4</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl opt">/</span><span class="hl num">4</span><span class="hl std">),</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

        <span class="hl com"># Condiciones que tenemos que comprobar </span>
        <span class="hl std">cara_cruz</span> <span class="hl kwb">&lt;-</span> <span class="hl std">dos_monedas[</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span> <span class="hl opt">&amp;&amp;</span> <span class="hl std">dos_monedas[</span><span class="hl num">2</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span>
        <span class="hl std">cruz_cara</span> <span class="hl kwb">&lt;-</span> <span class="hl std">dos_monedas[</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span> <span class="hl opt">&amp;&amp;</span> <span class="hl std">dos_monedas[</span><span class="hl num">2</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span>

        <span class="hl com"># Se tiene que obtener cara|cruz o cruz|cara, de otra manera volvemos a</span>
        <span class="hl com"># lanzar la moneda dos veces</span>
        <span class="hl kwa">if</span><span class="hl std">( cara_cruz</span> <span class="hl opt">||</span> <span class="hl std">cruz_cara){</span>
                <span class="hl kwd">return</span><span class="hl std">(dos_monedas)</span>
        <span class="hl std">}</span>       <span class="hl kwa">else</span> <span class="hl std">{</span>
                <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">lanzas_dos_monedas_truncadas</span><span class="hl std">())</span>
        <span class="hl std">}</span>
<span class="hl std">}</span>
<span class="hl com"># La función (aunque no es necesario) puede llamarse de la siguiente manera.</span>
<span class="hl kwd">lanzas_dos_monedas_truncadas</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Cruz&quot; &quot;Cara&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Después de crear esta función, creamos otra función simular_dos_monedas con el argumento </span>
<span class="hl com"># n veces que queremos repetir el lanzamiento de las dos monedas, hacemos detalle en que a</span>
<span class="hl com"># la función replicate le pasamos la función anterior. Contamos los casos que se cumple </span>
<span class="hl com"># el caso 1 o el caso 2 y vemos la proporción de estos, una ejecución con un alto número de </span>
<span class="hl com"># repeticiones hará que los valores observados coincidan con los teóricos.</span>
<span class="hl std">simular_dos_monedas</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">){</span>
        <span class="hl com"># Simulamos variable aleatoria</span>
        <span class="hl std">simulacion</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(n,</span> <span class="hl kwd">lanzas_dos_monedas_truncadas</span><span class="hl std">())</span>

        <span class="hl com"># Casos favorables</span>
        <span class="hl std">casos_cara_cruz</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>
        <span class="hl std">casos_cruz_cara</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>
        <span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl std">n){</span>
                <span class="hl kwa">if</span> <span class="hl std">(simulacion[,i][</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span> <span class="hl opt">&amp;&amp;</span> <span class="hl std">simulacion[,i][</span><span class="hl num">2</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span><span class="hl std">){</span>
                        <span class="hl std">casos_cara_cruz</span> <span class="hl kwb">&lt;-</span>      <span class="hl std">casos_cara_cruz</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl kwa">if</span> <span class="hl std">(simulacion[,i][</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cruz&quot;</span> <span class="hl opt">&amp;&amp;</span> <span class="hl std">simulacion[,i][</span><span class="hl num">2</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span><span class="hl std">){</span>
                        <span class="hl std">casos_cruz_cara</span> <span class="hl kwb">&lt;-</span>      <span class="hl std">casos_cruz_cara</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>

        <span class="hl com"># Proporcion </span>
        <span class="hl std">prob_cara_cruz</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_cara_cruz</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">prob_cruz_cara</span> <span class="hl kwb">&lt;-</span> <span class="hl std">casos_cruz_cara</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl std">}</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Frecuencias=&quot;</span><span class="hl std">=</span><span class="hl kwd">table</span><span class="hl std">(simulacion),</span>
                <span class="hl str">&quot;Proporción primera cara segunda cruz =&quot;</span><span class="hl std">=prob_cara_cruz,</span>
                <span class="hl str">&quot;Proporción primera cruz segunda cara =&quot;</span><span class="hl std">=prob_cruz_cara))</span>
<span class="hl std">}</span>
<span class="hl com"># Un ejemplo de ejecución es:</span>
<span class="hl kwd">simular_dos_monedas</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">15000</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias=`
## simulacion
##  Cara  Cruz 
## 15000 15000 
## 
## $`Proporción primera cara segunda cruz =`
## [1] 0.5024
## 
## $`Proporción primera cruz segunda cara =`
## [1] 0.4976
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Vemos que los valores observados son muy parecidos a los teóricos, 1/2</span>
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 6</h2>
		<div class="list-card">
			<h3>
				Considera una partícula que en el tiempo t=1, está en el punto, P=(0,0), del plano y se desplaza del
				siguiente modo:
				<br>
				En cada tiempo t, t=2,3,... se lanzan tres dados.
				Si el primer dado es 1 o 2, el punto se mueve una unidad a la derecha, si no lo hace a la izquierda.
				Si la suma del segundo dado y el tercero es menor que 5, el punto se mueve una unidad hacia arriba, si
				no, lo hace hacia abajo.
				<br>
				El proceso finaliza cuando la primera coordenada de la partícula, x, cumple que |x|>100.

				<ol>
					<li>1. Escribe una función que simule el movimiento de la partícula en función de t (Debes incluir
						un
						parámetro para limitar el número de movimientos por si nunca alcanza la condición de
						finalización) y
						devuelva:
						<ol>
							<li>-La progresión aleatoria definida</li>
							<li>-Cuantos pasos han sido necesarios para finalizar el movimiento</li>
							<li>-Si ha alcanzado o no la condición de salida</li>
						</ol>
					</li>
					<li>2. Realiza una simulación concreta del proceso con t=1000 y represéntala gráficamente</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución: Para probar las funciones solo hay que cargar el fichero y </span>
<span class="hl com"># llamarlas con su nombre. </span>

<span class="hl com"># Definimos una función lanzas_tres_dados, que consistirá en simular el lanzamiento de</span>
<span class="hl com"># 3 dados, devolvera un vector con 3 números que corresponderán a las 3 tiradas del dado</span>

<span class="hl std">lanzar_tres_dados</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span><span class="hl std">,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">))</span>
<span class="hl std">}</span>

<span class="hl com"># la función puede llamarse de la siguiente manera:</span>
<span class="hl kwd">lanzar_tres_dados</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 5 5 6
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Seguidamente, creamos una funcion para simular el movimiento de la párticula con la progresión </span>
<span class="hl com"># aleatoria pedida cuyo argumento sería el &quot;tiempo&quot; que queremos simular, creamos dos arrays </span>
<span class="hl com"># que corresponderan a la posicion eje x y al eje y de la particula, siendo los últimos elementos</span>
<span class="hl com"># la posición actual de la párticula. Utilizamos también una variable pasos para contabilizar los pasos</span>
<span class="hl com"># (hemos considerado que ocurre cada paso por cada movimiento vertical u horizontal de la párticula ,</span>
<span class="hl com"># es decir, si el primer dado es 1 o 2 un paso sería la partícula moviendose una unidad a la derecha,</span>
<span class="hl com"># si la suma del segundo y tercer dado es menor que 5, la partícula se movería hacia arriba y sería</span>
<span class="hl com"># otro paso, esto se puede cambiar fácilmente a otra posible adaptación). </span>
<span class="hl com"># Finalmente, utilizamos un booleano condicion_alcanzada para saber si la condición se ha cumplido o no.</span>
<span class="hl std">simulacion_particula</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">t</span> <span class="hl std">=</span> <span class="hl num">1000</span><span class="hl std">){</span>
        <span class="hl com"># Posición instante inicial partícula (0,0)</span>
        <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">vector</span><span class="hl std">(</span><span class="hl str">&quot;numeric&quot;</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">)</span>
        <span class="hl std">y</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">vector</span><span class="hl std">(</span><span class="hl str">&quot;numeric&quot;</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">)</span>
        <span class="hl std">pasos</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span>
        <span class="hl std">condicion_alcanzada</span> <span class="hl kwb">&lt;-</span> <span class="hl num">FALSE</span>

        <span class="hl com"># Limitamos el número de movimientos</span>
        <span class="hl std">maximo_tiempo</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">min</span><span class="hl std">(t,</span> <span class="hl num">1000</span><span class="hl std">)</span>

        <span class="hl kwa">for</span><span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">2</span><span class="hl opt">:</span><span class="hl std">maximo_tiempo){</span>
                <span class="hl com"># Por cada tiempo t lanzamos 3 dados</span>
                <span class="hl std">tres_dados</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">lanzar_tres_dados</span><span class="hl std">()</span>

                <span class="hl com"># Si el primer dado es 1 o 2, movemos el punto una unidad a la derecha</span>
                <span class="hl com"># si no, a la izquierda</span>
                <span class="hl kwa">if</span><span class="hl std">(tres_dados[</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl num">1</span> <span class="hl opt">||</span> <span class="hl std">tres_dados[</span><span class="hl num">1</span><span class="hl std">]</span> <span class="hl opt">==</span> <span class="hl num">2</span><span class="hl std">){</span>
                        <span class="hl std">unidad_x</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span>
                <span class="hl std">}</span> <span class="hl kwa">else</span> <span class="hl std">{</span>
                        <span class="hl std">unidad_x</span> <span class="hl kwb">&lt;-</span> <span class="hl opt">-</span><span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl com"># Actualizamos posición x</span>
                <span class="hl std">pasos</span> <span class="hl kwb">&lt;-</span> <span class="hl std">pasos</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">append</span><span class="hl std">(x, x[</span><span class="hl kwd">length</span><span class="hl std">(x)]</span> <span class="hl opt">+</span> <span class="hl std">unidad_x)</span>
                <span class="hl std">y</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">append</span><span class="hl std">(y, y[</span><span class="hl kwd">length</span><span class="hl std">(y)])</span>

                <span class="hl com"># Si la primera coordenada de la particula cumple abs(x) &gt; 100,</span>
                <span class="hl com"># el proceso finaliza	</span>
                <span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(x[</span><span class="hl kwd">length</span><span class="hl std">(x)])</span> <span class="hl opt">&gt;</span> <span class="hl num">100</span><span class="hl std">){</span>
                        <span class="hl std">condicion_alcanzada</span> <span class="hl kwb">&lt;-</span> <span class="hl num">TRUE</span>
                        <span class="hl kwa">break</span>
                <span class="hl std">}</span>
                <span class="hl com"># Si la suma del segundo dado y el tercero es menor que 5,</span>
                <span class="hl com"># el punto se mueve una unidad hacia arriba, si no, lo hace hacia abajo.</span>
                <span class="hl kwa">if</span><span class="hl std">(</span><span class="hl kwd">sum</span><span class="hl std">(tres_dados[</span><span class="hl num">2</span><span class="hl opt">:</span><span class="hl num">3</span><span class="hl std">])</span> <span class="hl opt">&lt;</span> <span class="hl num">5</span><span class="hl std">){</span>
                        <span class="hl std">unidad_y</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span>
                <span class="hl std">}</span> <span class="hl kwa">else</span> <span class="hl std">{</span>
                        <span class="hl std">unidad_y</span> <span class="hl kwb">&lt;-</span> <span class="hl opt">-</span><span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl com"># Actualizamos posicion y		</span>
                <span class="hl std">pasos</span> <span class="hl kwb">&lt;-</span> <span class="hl std">pasos</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">x</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">append</span><span class="hl std">(x, x[</span><span class="hl kwd">length</span><span class="hl std">(x)])</span>
                <span class="hl std">y</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">append</span><span class="hl std">(y, y[</span><span class="hl kwd">length</span><span class="hl std">(y)]</span> <span class="hl opt">+</span> <span class="hl std">unidad_y)</span>
        <span class="hl std">}</span>

        <span class="hl kwd">plot</span><span class="hl std">(x,y,</span> <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;b&quot;</span><span class="hl std">)</span>
        <span class="hl std">posicion_final</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;(&quot;</span><span class="hl std">, x[</span><span class="hl kwd">length</span><span class="hl std">(x)],</span> <span class="hl str">&quot;,&quot;</span><span class="hl std">, y[</span><span class="hl kwd">length</span><span class="hl std">(y)],</span> <span class="hl str">&quot;)&quot;</span><span class="hl std">)</span>
        <span class="hl std">progresion</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(x,y)</span>
        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Progresión aleatoria=&quot;</span><span class="hl std">=progresion,</span>
                        <span class="hl str">&quot;Posición final=&quot;</span><span class="hl std">= posicion_final,</span>
                        <span class="hl str">&quot;Condición alcanzada=&quot;</span><span class="hl std">=condicion_alcanzada,</span>
                        <span class="hl str">&quot;Pasos realizados=&quot;</span><span class="hl std">=pasos))</span>
<span class="hl std">}</span>

<span class="hl com"># Hacemos hincapié en que siempre vamos a limitar como máximo de tiempo 1000, la función devolverá</span>
<span class="hl com"># la progresión aleatoria seguida, la posición final, si la condición ha sido alcanzada o no y los pasos </span>
<span class="hl com"># realizados.</span>
<span class="hl com"># Un ejemplo de ejecución sería:</span>
<span class="hl kwd">simulacion_particula</span><span class="hl std">(</span><span class="hl kwc">t</span> <span class="hl std">=</span> <span class="hl num">1000</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-7-1.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" class="plot" /></div><div class="rcode">
<div class="output"><pre class="knitr r">## $`Progresión aleatoria=`
##   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## x    0   -1   -1   -2   -2   -1   -1   -2   -2    -1    -1    -2    -2    -3    -3    -4    -4    -3    -3    -2    -2    -1    -1    -2
## y    0    0   -1   -1   -2   -2   -3   -3   -2    -2    -3    -3    -4    -4    -3    -3    -4    -4    -5    -5    -4    -4    -5    -5
##   [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46]
## x    -2    -3    -3    -4    -4    -3    -3    -2    -2    -1    -1    -2    -2    -3    -3    -4    -4    -5    -5    -6    -6    -5
## y    -6    -6    -5    -5    -6    -6    -7    -7    -8    -8    -9    -9   -10   -10   -11   -11   -10   -10    -9    -9    -8    -8
##   [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68]
## x    -5    -4    -4    -5    -5    -6    -6    -7    -7    -6    -6    -5    -5    -4    -4    -5    -5    -4    -4    -5    -5    -4
## y    -9    -9   -10   -10   -11   -11   -12   -12   -13   -13   -14   -14   -15   -15   -16   -16   -17   -17   -18   -18   -19   -19
##   [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88] [,89] [,90]
## x    -4    -5    -5    -4    -4    -3    -3    -4    -4    -5    -5    -4    -4    -3    -3    -4    -4    -5    -5    -6    -6    -5
## y   -20   -20   -21   -21   -22   -22   -21   -21   -22   -22   -21   -21   -20   -20   -21   -21   -22   -22   -23   -23   -24   -24
##   [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99] [,100] [,101] [,102] [,103] [,104] [,105] [,106] [,107] [,108] [,109] [,110]
## x    -5    -6    -6    -7    -7    -8    -8    -7    -7     -6     -6     -5     -5     -6     -6     -5     -5     -6     -6     -5
## y   -25   -25   -24   -24   -25   -25   -26   -26   -27    -27    -28    -28    -29    -29    -30    -30    -31    -31    -32    -32
##   [,111] [,112] [,113] [,114] [,115] [,116] [,117] [,118] [,119] [,120] [,121] [,122] [,123] [,124] [,125] [,126] [,127] [,128] [,129]
## x     -5     -6     -6     -5     -5     -6     -6     -5     -5     -6     -6     -5     -5     -6     -6     -7     -7     -6     -6
## y    -33    -33    -32    -32    -33    -33    -32    -32    -33    -33    -34    -34    -33    -33    -34    -34    -35    -35    -36
##   [,130] [,131] [,132] [,133] [,134] [,135] [,136] [,137] [,138] [,139] [,140] [,141] [,142] [,143] [,144] [,145] [,146] [,147] [,148]
## x     -7     -7     -8     -8     -9     -9    -10    -10    -11    -11    -12    -12    -13    -13    -14    -14    -13    -13    -14
## y    -36    -37    -37    -38    -38    -39    -39    -40    -40    -41    -41    -42    -42    -43    -43    -42    -42    -43    -43
##   [,149] [,150] [,151] [,152] [,153] [,154] [,155] [,156] [,157] [,158] [,159] [,160] [,161] [,162] [,163] [,164] [,165] [,166] [,167]
## x    -14    -13    -13    -12    -12    -13    -13    -12    -12    -11    -11    -12    -12    -11    -11    -10    -10     -9     -9
## y    -44    -44    -45    -45    -46    -46    -47    -47    -48    -48    -49    -49    -50    -50    -51    -51    -52    -52    -51
##   [,168] [,169] [,170] [,171] [,172] [,173] [,174] [,175] [,176] [,177] [,178] [,179] [,180] [,181] [,182] [,183] [,184] [,185] [,186]
## x    -10    -10     -9     -9     -8     -8     -9     -9     -8     -8     -9     -9    -10    -10    -11    -11    -12    -12    -13
## y    -51    -52    -52    -53    -53    -54    -54    -55    -55    -56    -56    -57    -57    -58    -58    -57    -57    -58    -58
##   [,187] [,188] [,189] [,190] [,191] [,192] [,193] [,194] [,195] [,196] [,197] [,198] [,199] [,200] [,201] [,202] [,203] [,204] [,205]
## x    -13    -12    -12    -11    -11    -10    -10     -9     -9    -10    -10    -11    -11    -12    -12    -13    -13    -12    -12
## y    -59    -59    -58    -58    -59    -59    -60    -60    -59    -59    -60    -60    -61    -61    -60    -60    -61    -61    -60
##   [,206] [,207] [,208] [,209] [,210] [,211] [,212] [,213] [,214] [,215] [,216] [,217] [,218] [,219] [,220] [,221] [,222] [,223] [,224]
## x    -13    -13    -12    -12    -11    -11    -12    -12    -13    -13    -14    -14    -15    -15    -14    -14    -15    -15    -16
## y    -60    -61    -61    -62    -62    -63    -63    -64    -64    -65    -65    -66    -66    -67    -67    -66    -66    -67    -67
##   [,225] [,226] [,227] [,228] [,229] [,230] [,231] [,232] [,233] [,234] [,235] [,236] [,237] [,238] [,239] [,240] [,241] [,242] [,243]
## x    -16    -17    -17    -18    -18    -19    -19    -20    -20    -19    -19    -20    -20    -21    -21    -20    -20    -21    -21
## y    -68    -68    -69    -69    -70    -70    -71    -71    -72    -72    -71    -71    -72    -72    -73    -73    -74    -74    -73
##   [,244] [,245] [,246] [,247] [,248] [,249] [,250] [,251] [,252] [,253] [,254] [,255] [,256] [,257] [,258] [,259] [,260] [,261] [,262]
## x    -22    -22    -23    -23    -24    -24    -23    -23    -24    -24    -25    -25    -26    -26    -25    -25    -26    -26    -27
## y    -73    -74    -74    -75    -75    -76    -76    -77    -77    -78    -78    -79    -79    -80    -80    -81    -81    -82    -82
##   [,263] [,264] [,265] [,266] [,267] [,268] [,269] [,270] [,271] [,272] [,273] [,274] [,275] [,276] [,277] [,278] [,279] [,280] [,281]
## x    -27    -28    -28    -27    -27    -28    -28    -29    -29    -30    -30    -31    -31    -32    -32    -33    -33    -34    -34
## y    -83    -83    -84    -84    -85    -85    -86    -86    -87    -87    -88    -88    -89    -89    -90    -90    -91    -91    -92
##   [,282] [,283] [,284] [,285] [,286] [,287] [,288] [,289] [,290] [,291] [,292] [,293] [,294] [,295] [,296] [,297] [,298] [,299] [,300]
## x    -35    -35    -36    -36    -37    -37    -36    -36    -37    -37    -38    -38    -39    -39    -40    -40    -39    -39    -40
## y    -92    -93    -93    -94    -94    -93    -93    -92    -92    -93    -93    -94    -94    -95    -95    -96    -96    -97    -97
##   [,301] [,302] [,303] [,304] [,305] [,306] [,307] [,308] [,309] [,310] [,311] [,312] [,313] [,314] [,315] [,316] [,317] [,318] [,319]
## x    -40    -41    -41    -42    -42    -43    -43    -44    -44    -43    -43    -44    -44    -45    -45    -46    -46    -45    -45
## y    -98    -98    -99    -99   -100   -100   -101   -101   -102   -102   -103   -103   -104   -104   -105   -105   -104   -104   -105
##   [,320] [,321] [,322] [,323] [,324] [,325] [,326] [,327] [,328] [,329] [,330] [,331] [,332] [,333] [,334] [,335] [,336] [,337] [,338]
## x    -46    -46    -47    -47    -48    -48    -47    -47    -46    -46    -47    -47    -48    -48    -47    -47    -48    -48    -49
## y   -105   -106   -106   -107   -107   -108   -108   -109   -109   -110   -110   -111   -111   -112   -112   -113   -113   -114   -114
##   [,339] [,340] [,341] [,342] [,343] [,344] [,345] [,346] [,347] [,348] [,349] [,350] [,351] [,352] [,353] [,354] [,355] [,356] [,357]
## x    -49    -50    -50    -51    -51    -50    -50    -51    -51    -52    -52    -53    -53    -54    -54    -53    -53    -52    -52
## y   -115   -115   -116   -116   -117   -117   -118   -118   -119   -119   -118   -118   -119   -119   -120   -120   -121   -121   -120
##   [,358] [,359] [,360] [,361] [,362] [,363] [,364] [,365] [,366] [,367] [,368] [,369] [,370] [,371] [,372] [,373] [,374] [,375] [,376]
## x    -53    -53    -54    -54    -53    -53    -54    -54    -55    -55    -56    -56    -55    -55    -54    -54    -53    -53    -52
## y   -120   -119   -119   -120   -120   -121   -121   -122   -122   -123   -123   -124   -124   -125   -125   -126   -126   -127   -127
##   [,377] [,378] [,379] [,380] [,381] [,382] [,383] [,384] [,385] [,386] [,387] [,388] [,389] [,390] [,391] [,392] [,393] [,394] [,395]
## x    -52    -53    -53    -54    -54    -55    -55    -56    -56    -55    -55    -54    -54    -55    -55    -54    -54    -53    -53
## y   -126   -126   -127   -127   -128   -128   -129   -129   -130   -130   -131   -131   -130   -130   -131   -131   -132   -132   -133
##   [,396] [,397] [,398] [,399] [,400] [,401] [,402] [,403] [,404] [,405] [,406] [,407] [,408] [,409] [,410] [,411] [,412] [,413] [,414]
## x    -52    -52    -51    -51    -52    -52    -53    -53    -54    -54    -55    -55    -54    -54    -55    -55    -56    -56    -55
## y   -133   -132   -132   -133   -133   -132   -132   -133   -133   -134   -134   -133   -133   -132   -132   -131   -131   -132   -132
##   [,415] [,416] [,417] [,418] [,419] [,420] [,421] [,422] [,423] [,424] [,425] [,426] [,427] [,428] [,429] [,430] [,431] [,432] [,433]
## x    -55    -56    -56    -57    -57    -58    -58    -59    -59    -58    -58    -59    -59    -58    -58    -59    -59    -60    -60
## y   -133   -133   -134   -134   -135   -135   -134   -134   -133   -133   -134   -134   -135   -135   -136   -136   -137   -137   -138
##   [,434] [,435] [,436] [,437] [,438] [,439] [,440] [,441] [,442] [,443] [,444] [,445] [,446] [,447] [,448] [,449] [,450] [,451] [,452]
## x    -59    -59    -60    -60    -61    -61    -62    -62    -63    -63    -64    -64    -65    -65    -64    -64    -65    -65    -64
## y   -138   -139   -139   -140   -140   -139   -139   -140   -140   -141   -141   -142   -142   -143   -143   -142   -142   -143   -143
##   [,453] [,454] [,455] [,456] [,457] [,458] [,459] [,460] [,461] [,462] [,463] [,464] [,465] [,466] [,467] [,468] [,469] [,470] [,471]
## x    -64    -65    -65    -66    -66    -67    -67    -66    -66    -67    -67    -68    -68    -69    -69    -70    -70    -69    -69
## y   -142   -142   -143   -143   -144   -144   -145   -145   -146   -146   -147   -147   -148   -148   -149   -149   -150   -150   -151
##   [,472] [,473] [,474] [,475] [,476] [,477] [,478] [,479] [,480] [,481] [,482] [,483] [,484] [,485] [,486] [,487] [,488] [,489] [,490]
## x    -68    -68    -69    -69    -70    -70    -71    -71    -70    -70    -69    -69    -68    -68    -67    -67    -66    -66    -67
## y   -151   -152   -152   -151   -151   -150   -150   -151   -151   -152   -152   -153   -153   -154   -154   -155   -155   -156   -156
##   [,491] [,492] [,493] [,494] [,495] [,496] [,497] [,498] [,499] [,500] [,501] [,502] [,503] [,504] [,505] [,506] [,507] [,508] [,509]
## x    -67    -68    -68    -67    -67    -68    -68    -69    -69    -70    -70    -69    -69    -70    -70    -71    -71    -70    -70
## y   -157   -157   -158   -158   -159   -159   -160   -160   -161   -161   -162   -162   -163   -163   -164   -164   -165   -165   -166
##   [,510] [,511] [,512] [,513] [,514] [,515] [,516] [,517] [,518] [,519] [,520] [,521] [,522] [,523] [,524] [,525] [,526] [,527] [,528]
## x    -71    -71    -72    -72    -73    -73    -74    -74    -75    -75    -76    -76    -77    -77    -78    -78    -79    -79    -80
## y   -166   -167   -167   -168   -168   -169   -169   -170   -170   -171   -171   -172   -172   -173   -173   -174   -174   -175   -175
##   [,529] [,530] [,531] [,532] [,533] [,534] [,535] [,536] [,537] [,538] [,539] [,540] [,541] [,542] [,543] [,544] [,545] [,546] [,547]
## x    -80    -79    -79    -80    -80    -81    -81    -82    -82    -81    -81    -80    -80    -81    -81    -82    -82    -81    -81
## y   -176   -176   -175   -175   -176   -176   -177   -177   -176   -176   -177   -177   -178   -178   -177   -177   -178   -178   -179
##   [,548] [,549] [,550] [,551] [,552] [,553] [,554] [,555] [,556] [,557] [,558] [,559] [,560] [,561] [,562] [,563] [,564] [,565] [,566]
## x    -82    -82    -83    -83    -84    -84    -83    -83    -84    -84    -85    -85    -86    -86    -85    -85    -86    -86    -87
## y   -179   -180   -180   -181   -181   -182   -182   -183   -183   -184   -184   -185   -185   -186   -186   -187   -187   -186   -186
##   [,567] [,568] [,569] [,570] [,571] [,572] [,573] [,574] [,575] [,576] [,577] [,578] [,579] [,580] [,581] [,582] [,583] [,584] [,585]
## x    -87    -88    -88    -87    -87    -86    -86    -87    -87    -86    -86    -87    -87    -86    -86    -87    -87    -88    -88
## y   -187   -187   -188   -188   -189   -189   -188   -188   -189   -189   -190   -190   -191   -191   -192   -192   -191   -191   -192
##   [,586] [,587] [,588] [,589] [,590] [,591] [,592] [,593] [,594] [,595] [,596] [,597] [,598] [,599] [,600] [,601] [,602] [,603] [,604]
## x    -89    -89    -88    -88    -87    -87    -88    -88    -89    -89    -90    -90    -91    -91    -92    -92    -93    -93    -92
## y   -192   -193   -193   -194   -194   -195   -195   -196   -196   -197   -197   -198   -198   -199   -199   -200   -200   -201   -201
##   [,605] [,606] [,607] [,608] [,609] [,610] [,611] [,612] [,613] [,614] [,615] [,616] [,617] [,618] [,619] [,620] [,621] [,622] [,623]
## x    -92    -93    -93    -92    -92    -93    -93    -94    -94    -93    -93    -92    -92    -93    -93    -94    -94    -93    -93
## y   -202   -202   -203   -203   -204   -204   -205   -205   -204   -204   -205   -205   -206   -206   -205   -205   -206   -206   -207
##   [,624] [,625] [,626] [,627] [,628] [,629] [,630] [,631] [,632] [,633] [,634] [,635] [,636] [,637] [,638] [,639] [,640] [,641] [,642]
## x    -92    -92    -93    -93    -94    -94    -93    -93    -92    -92    -93    -93    -92    -92    -93    -93    -92    -92    -91
## y   -207   -208   -208   -209   -209   -210   -210   -211   -211   -210   -210   -211   -211   -212   -212   -213   -213   -214   -214
##   [,643] [,644] [,645] [,646] [,647] [,648] [,649] [,650] [,651] [,652] [,653] [,654] [,655] [,656] [,657] [,658] [,659] [,660] [,661]
## x    -91    -92    -92    -93    -93    -94    -94    -95    -95    -96    -96    -97    -97    -98    -98    -97    -97    -98    -98
## y   -215   -215   -214   -214   -215   -215   -216   -216   -217   -217   -218   -218   -219   -219   -220   -220   -221   -221   -222
##   [,662] [,663] [,664] [,665] [,666]
## x    -99    -99   -100   -100   -101
## y   -222   -223   -223   -224   -224
## 
## $`Posición final=`
## [1] &quot;( -101 , -224 )&quot;
## 
## $`Condición alcanzada=`
## [1] TRUE
## 
## $`Pasos realizados=`
## [1] 665
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 7</h2>
		<div class="list-card">
			<h3>
				Antoine Gombard, Chevalier de Méré, 1º problema (El problema de la partida interrumpida). Dos jugadores
				A y B apuestan a cara o cruz, tirando una moneda (teóricamente, equilibrada). El jugador que primero
				llegue a seis puntos gana la apuesta. En un momento en que A tiene 4 puntos y B tiene 3 puntos, deben
				suspender el juego. ¿Cómo deben repartir la cantidad apostada para ser justos?
				<br>
				Resuelve el problema teóricamente.
				<ol>
					<li>1) Escribe una función que, a partir del resultado en el momento en que se suspende el juego,
						simule quién ganaría.</li>
					<li>2) Escribe una función que permita realizar n veces esa simulación.</li>
					<li>3) Realiza una simulación con n=98765 e indica la diferencia entre los valores observados y los
						predichos.</li>
					<li>4) Mejora la función para que los puntos de cada jugador en el momento de la interrupción y el
						total de partidas para obtener la victoria sean arbitrarios. Incluye en valor máximo para
						garantizar que se detiene la simulación.</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución: Parece que lo más justo sea tener en cuenta cuántas veces ganaría A y </span>
<span class="hl com"># cuántas veces ganaría B, repitiéndose muchas veces. Como el juego se puede alargar como máximo cuatro </span>
<span class="hl com"># partidas más, se consideran todos los resultados si se jugaran las tres partidas y se cuentan los casos</span>
<span class="hl com"># favorables a cada jugador. Las probabilidades de sacar cara y cruz son iguales, 1/2</span>
<span class="hl com"># Con esto, las probabilidades de que gane A son:</span>
<span class="hl com"># (Cara + cara) 1/4 + (Cara + cruz + cara) 1/8 + (cara + cruz + cruz + cara) + 1/16 +</span>
<span class="hl com"># (cruz + cara + cara) 1/8 + (cruz + cara + cruz + cara) 1/16 + (cruz + cruz + cara + cara ) 1/16 = 11/16</span>
<span class="hl com"># De igual manera para B</span>
<span class="hl com"># (cara + cruz + cruz + cruz) 1/16 + (cruz + cara + cruz + cruz) 1/16 +</span>
<span class="hl com"># (cruz + cruz + cara + cruz) 1/16 + (cruz + cruz + cruz) 1/8 = 1 - 11/16 = 5/16</span>
<span class="hl com"># Siendo esas la propoción que debe seguir para repartir la cantidad apostada.</span>

<span class="hl com"># Creamos una función simulacion_juego cuyos argumentos son la puntuación de A, la puntuación de B, y</span>
<span class="hl com"># los puntos necesarios para ganar, y simulamos el juego a partir de ese momento.</span>

<span class="hl std">simulacion_juego</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">puntuacion_A</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">puntuacion_B</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl kwc">puntos_necesarios</span> <span class="hl std">=</span> <span class="hl num">6</span><span class="hl std">){</span>

        <span class="hl std">no_ganador</span> <span class="hl kwb">&lt;-</span> <span class="hl num">TRUE</span>
        <span class="hl std">moneda</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Cara&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Cruz&quot;</span><span class="hl std">)</span>

        <span class="hl com"># Entramos en un bucle hasta que alguno gane	 </span>
        <span class="hl kwa">while</span><span class="hl std">(no_ganador){</span>
                <span class="hl std">lanzamiento_moneda</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(moneda,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>

                <span class="hl kwa">if</span><span class="hl std">(lanzamiento_moneda</span> <span class="hl opt">==</span> <span class="hl str">&quot;Cara&quot;</span><span class="hl std">){</span>
                        <span class="hl std">puntuacion_A</span> <span class="hl kwb">&lt;-</span> <span class="hl std">puntuacion_A</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span> <span class="hl kwa">else</span> <span class="hl std">{</span>
                        <span class="hl std">puntuacion_B</span> <span class="hl kwb">&lt;-</span> <span class="hl std">puntuacion_B</span> <span class="hl opt">+</span> <span class="hl num">1</span>
                <span class="hl std">}</span>

                <span class="hl kwa">if</span><span class="hl std">(puntuacion_A</span> <span class="hl opt">==</span> <span class="hl std">puntos_necesarios){</span>
                        <span class="hl std">no_ganador</span> <span class="hl kwb">&lt;-</span> <span class="hl num">FALSE</span>
                        <span class="hl std">ganador</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Ganador: A&quot;</span>
                <span class="hl std">}</span>

                <span class="hl kwa">if</span><span class="hl std">(puntuacion_B</span> <span class="hl opt">==</span> <span class="hl std">puntos_necesarios){</span>
                        <span class="hl std">no_ganador</span> <span class="hl kwb">&lt;-</span> <span class="hl num">FALSE</span>
                        <span class="hl std">ganador</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Ganador: B&quot;</span>
                <span class="hl std">}</span>
        <span class="hl std">}</span>

        <span class="hl kwd">return</span><span class="hl std">(ganador)</span>
<span class="hl std">}</span>
<span class="hl com"># Se puede llamar a la función mediante su nombre simplemente con los valores predeterminados</span>
<span class="hl kwd">simulacion_juego</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Ganador: A&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Seguidamente, creamos una función, n_veces_juego que permite realizar n veces esa simulación, </span>
<span class="hl com"># ejecuta simplemente pasandole como argumento el número de veces que se quiere replicar el juego.</span>
<span class="hl std">n_veces_juego</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">98765</span><span class="hl std">,</span> <span class="hl kwc">puntuacion_A</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">puntuacion_B</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">,</span> <span class="hl kwc">puntos_necesarios</span> <span class="hl std">=</span> <span class="hl num">6</span><span class="hl std">){</span>
        <span class="hl com"># Reproducimos el juego n veces</span>
        <span class="hl std">n_juegos</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(n,</span> <span class="hl kwd">simulacion_juego</span><span class="hl std">(puntuacion_A, puntuacion_B, puntos_necesarios))</span>

        <span class="hl com"># Tabla de frecuencias </span>
        <span class="hl std">freq</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl std">(n_juegos)</span>

        <span class="hl com"># Proporción de veces que gana A o B</span>
        <span class="hl std">prob_A</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span> <span class="hl std">(n_juegos</span> <span class="hl opt">==</span> <span class="hl str">&quot;Ganador: A&quot;</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>
        <span class="hl std">prob_B</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span> <span class="hl std">(n_juegos</span> <span class="hl opt">==</span> <span class="hl str">&quot;Ganador: B&quot;</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">n</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">list</span><span class="hl std">(</span><span class="hl str">&quot;Frecuencias=&quot;</span><span class="hl std">=freq,</span>
                                <span class="hl str">&quot;Proporción de veces que gana A=&quot;</span><span class="hl std">=prob_A,</span>
                                <span class="hl str">&quot;Proporción de veces que gana B=&quot;</span><span class="hl std">=prob_B))</span>
<span class="hl std">}</span>
<span class="hl kwd">n_veces_juego</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">98765</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $`Frecuencias=`
## n_juegos
## Ganador: A Ganador: B 
##      67899      30866 
## 
## $`Proporción de veces que gana A=`
## [1] 0.6874804
## 
## $`Proporción de veces que gana B=`
## [1] 0.3125196
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># La función devolverá una tabla con la frecuencia de los ganadores, ganador A o ganador B, junto a la </span>
<span class="hl com"># proporción de veces que gana cada uno. Vemos que para un n elevado, como es el caso de n=98765,</span>
<span class="hl com"># los valores observados coinciden con los teóricos cuando nuestras repeticiones son bastante grandes.</span>

<span class="hl com"># Finalmente, creamos una función simulacion_juego_mejorado, con los parámetros de simulacion_juego</span>
<span class="hl com"># pero arbitrarios, con el detalle de que las respectivas puntuaciones estarán limitadas </span>
<span class="hl com"># al parámetro arbitrario de la puntuación necesaria para ganar.</span>
<span class="hl com"># Función mejorada con datos arbitrarios</span>
<span class="hl std">simulacion_juego_mejorado</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(){</span>

        <span class="hl std">puntos_necesarios</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">1000</span><span class="hl std">,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Puntos para ganar&quot;</span><span class="hl std">,puntos_necesarios))</span>
        <span class="hl com"># No tiene sentido empezar con puntos arbitrarios mayores que los necesarios</span>
        <span class="hl com"># limitamos ambas puntuaciones a ello</span>
        <span class="hl std">puntuacion_A</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl opt">:</span><span class="hl std">puntos_necesarios,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Puntos que tiene A&quot;</span><span class="hl std">,puntuacion_A))</span>
        <span class="hl std">puntuacion_B</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl opt">:</span><span class="hl std">puntos_necesarios,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
        <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Puntos que tiene B&quot;</span><span class="hl std">,puntuacion_B))</span>

        <span class="hl com"># Simulamos el juego con estos valores</span>
        <span class="hl kwd">simulacion_juego</span><span class="hl std">(puntuacion_A, puntuacion_B, puntos_necesarios)</span>
<span class="hl std">}</span>
<span class="hl com"># Se puede llamar a la función de la siguiente manera:</span>
<span class="hl kwd">simulacion_juego_mejorado</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Puntos para ganar 615&quot;
## [1] &quot;Puntos que tiene A 318&quot;
## [1] &quot;Puntos que tiene B 380&quot;
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Ganador: B&quot;
</pre></div>
</div></div>
	</div>

	<div class="container">
		<h2 class="section-title">Ejercicio 8</h2>
		<div class="list-card">
			<h3>
				Antoine Gombard, Chevalier de Méré, 2º problema. Se pensaba que era ventajoso apostar por obtener al
				menos un seis en una serie de 4 lanzamientos de un dado. Se argumentó que también sería ventajoso
				apostar por obtener al menos un doble seis en una serie de 24 lanzamientos con un par de dados. ¿Son
				ciertas cada una de las suposiciones? (No es necesario que resuelvas teóricamente los apartados)

				<ol>
					<li>1) Escribe una función que simule el lanzamiento de un dado n veces y devuelva el número de
						seises que se obtienen</li>
					<li>2) Escribe una función que permita realizar j veces esa simulación</li>
					<li>3) Siendo n=4 y j=10000 realiza una simulación e indica si el valor observado es compatible con
						la hipótesis</li>
					<li>4) Escribe una función que simule el lanzamiento de dos dados n veces y devuelva el número de
						dobles seises que se obtienen</li>
					<li>5) Escribe una función que permita realizar j veces esa simulación</li>
					<li>6) Siendo n=24 y j=10000 realiza una simulación e indica si el valor observado es compatible con
						la hipótesis</li>
				</ol>
			</h3>
		</div>
<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Solución: </span>
<span class="hl com"># Parte teórica (aunque no sea necesaria)</span>
<span class="hl com"># Al lanzar 4 veces un dado, se pueden obtener 6*6*6*6 = 1296 resultados. De esos resultados</span>
<span class="hl com"># puede salir resultados de 1 a 5 cuatro veces seguidas, 5*5*5*5 = 625 veces, luego los resultados que contienen</span>
<span class="hl com"># al menos un 6 son los totales menos estos, 1296 - 625 = 671. Luego en 4 lanzamientos de un dado hay más </span>
<span class="hl com"># resultados que contienen algún 6 (671) que resultados con ningún seis (625), por eso es más ventajoso.</span>
<span class="hl com"># 671/1296 = 0.51774</span>
<span class="hl com"># 625/1296 = 0.48225</span>

<span class="hl com"># Respecto a la segunda suposición, un par de dados son 6*6 = 36 resultados, 24 lanzamientos de un par de dados</span>
<span class="hl com"># será multiplicar 36 24 veces, 36^24 partidas posibles.</span>
<span class="hl com"># Vemos cuantas de esas partidas son favorables a obtener al menos un doble 6, como hemos visto antes,</span>
<span class="hl com"># en un par de dados hay 36-1=35 resultados que no son doble 6, 35^24 con ningun doble 6.</span>
<span class="hl com"># La proporción de partidas con ningún doble 6 sería: </span>
<span class="hl com"># (35^24) / (36^24) = 0.5085961</span>
<span class="hl com"># Mientras que la proporción con al menos un doble seis</span>
<span class="hl com"># 1 - [(35^24) / (36^24)] = 0.4914039</span>
<span class="hl com"># En este caso saldría perdiendo el que apuesta, aunque la diferencia sea muy pequeña si se juega muchas veces</span>
<span class="hl com"># esta desventaja se puede llegar a notar.</span>

<span class="hl com"># Parte práctica</span>
<span class="hl com"># 1) Creamos la función lanzar_dado_n_veces, que simula el lanzamiento de un dado n veces (lanzar_dado)</span>
<span class="hl com"># y devuelve el número de lanzamientos cuyo resultado ha sido un 6.</span>

<span class="hl std">lanzar_dado</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
        <span class="hl std">caras</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span>
        <span class="hl com"># Devolvemos el lanzamiento de 1 dado</span>
        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">))</span>
<span class="hl std">}</span>

<span class="hl std">lanzar_dado_n_veces</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">){</span>
        <span class="hl std">lanzamientos</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(n,</span> <span class="hl kwd">lanzar_dado</span><span class="hl std">())</span>
        <span class="hl std">suma_de_seis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(lanzamientos</span> <span class="hl opt">==</span> <span class="hl num">6</span><span class="hl std">)</span>

        <span class="hl kwd">return</span><span class="hl std">(suma_de_seis)</span>
<span class="hl std">}</span>

<span class="hl kwd">lanzar_dado_n_veces</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># 2) Seguidamente, definimos la función simulacion_dado(j, n), que permita realizar j veces la simulación</span>
<span class="hl com"># de lanzar el dado n veces.</span>


<span class="hl std">simulacion_dado</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">j</span> <span class="hl std">=</span> <span class="hl num">10000</span><span class="hl std">,</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">){</span>
        <span class="hl std">lanzamientos</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(j,</span> <span class="hl kwd">lanzar_dado_n_veces</span><span class="hl std">(n))</span>

        <span class="hl std">casos_seis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(lanzamientos</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">j</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Proporción de veces que ha salido un 6 con un dado en 4 tiradas: &quot;</span><span class="hl std">, casos_seis))</span>
<span class="hl std">}</span>
<span class="hl com"># Contamos las veces que ha salido al menos un 6, como la función lanzar_dado_n_veces devuelve la</span>
<span class="hl com"># suma de veces que el lanzamiento ha sido un 6, bastará con comprobar los lanzamientos que son mayores</span>
<span class="hl com"># que 0.</span>

<span class="hl com"># 3) Ejecutando la función con j = 10000 y n = 4, obtenemos el resultado de 0.51809, </span>
<span class="hl com"># lo cúal coincide con el valor teórico que esperabamos</span>
<span class="hl kwd">simulacion_dado</span><span class="hl std">(</span><span class="hl kwc">j</span> <span class="hl std">=</span> <span class="hl num">10000</span><span class="hl std">,</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Proporción de veces que ha salido un 6 con un dado en 4 tiradas:  0.522&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># 4) Realizamos el mismo procedimiento que hemos hecho con un dado, pero con dos dados,</span>
<span class="hl com"># creamos la función lanzar_dos_dados que simula el lanzamiento de dos dados,</span>
<span class="hl com"># y la función lanzar_dos_dados_n_veces, con la excepción de que en la función lanzar dos </span>
<span class="hl com"># dados devolvemos la suma de ambos dados, así en lanzar_dos_dados_n_veces para contar</span>
<span class="hl com"># los lanzamientos que han tenido doble seis comprobaremos aquellos cuya suma es 6+6=12</span>
<span class="hl std">lanzar_dos_dados</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(){</span>
        <span class="hl std">caras</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span>
        <span class="hl com"># Devolvemos el lanzamiento de 2 dados</span>
        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">sample</span><span class="hl std">(caras,</span> <span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span> <span class="hl kwc">replace</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)))</span>
<span class="hl std">}</span>

<span class="hl kwd">lanzar_dos_dados</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 6
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">lanzar_dos_dados_n_veces</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">){</span>
        <span class="hl std">lanzamientos</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(n,</span> <span class="hl kwd">lanzar_dos_dados</span><span class="hl std">())</span>
        <span class="hl std">suma_dos_seis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(lanzamientos</span> <span class="hl opt">==</span> <span class="hl num">12</span><span class="hl std">)</span>

        <span class="hl kwd">return</span><span class="hl std">(suma_dos_seis)</span>
<span class="hl std">}</span>

<span class="hl kwd">lanzar_dos_dados_n_veces</span><span class="hl std">(</span><span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">24</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># 5) Como hemos hecho en los apartados anteriores, creamos la función simulacion_dos_dados, </span>
<span class="hl com"># la cuál nos permite replicar j veces el experimento de lanzar n veces 2 dados.</span>
<span class="hl com"># Devolvemos la proporción de veces cuyos resultados han sido al menos un doble seis en n tiradas</span>
<span class="hl std">simulacion_dos_dados</span> <span class="hl kwb">=</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">j</span> <span class="hl std">=</span> <span class="hl num">10000</span><span class="hl std">,</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">24</span><span class="hl std">){</span>
        <span class="hl std">lanzamientos</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">replicate</span><span class="hl std">(j,</span> <span class="hl kwd">lanzar_dos_dados_n_veces</span><span class="hl std">(n))</span>

        <span class="hl std">casos_dos_seis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl std">(lanzamientos</span> <span class="hl opt">&gt;</span> <span class="hl num">0</span><span class="hl std">)</span> <span class="hl opt">/</span> <span class="hl std">j</span>

        <span class="hl kwd">return</span><span class="hl std">(</span><span class="hl kwd">paste</span><span class="hl std">(</span><span class="hl str">&quot;Proporción de veces que han salido dobles 6 con dos dados en 24 tiradas: &quot;</span><span class="hl std">, casos_dos_seis))</span>
<span class="hl std">}</span>
<span class="hl com"># 6) Ejecutando, </span>
<span class="hl kwd">simulacion_dos_dados</span><span class="hl std">(</span><span class="hl kwc">j</span> <span class="hl std">=</span> <span class="hl num">10000</span><span class="hl std">,</span> <span class="hl kwc">n</span> <span class="hl std">=</span> <span class="hl num">24</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Proporción de veces que han salido dobles 6 con dos dados en 24 tiradas:  0.4923&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># vemos que coincide con el valor teórico que esperabamos</span>
</pre></div>
</div></div>
	</div>

	<br><br>

	<footer class="container">
		<span style="font-size: 16px; margin-top: 16px">Coded by <a href="https://newtodesign.com/">New to design </a>
			Designed by <a
				href="https://dribbble.com/shots/4342703-Minimal-resume-freebie-for-junior-self-taught-people">Nicolas
				Meuzard</a></span>
	</footer>


</body>

</html>
